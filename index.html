<!DOCTYPE html>
<html>

<head>
	<title>My Page Title</title>
	<link rel="shortcut-icon" type="image/x-icon" href="favicon.ico">
	<script src="script.js" type="text/javascript"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
	</link>
	<script>

		window.onload = function () {

			//loadJSONtasks();
			displayJSONtasks(loadJSONtasks())
			//alert(loadJSONtasks());
		}


		var id = 0;
		// Why do i have to write a script here in html doc and it doesnt load the fucntion
		// defined in the src script???
		function deleteTask(id) {
			document.getElementById(id).remove();
			return;
		}




		function addTask() {



			/*
			// alert("caling addtask")
			let new_task_input = document.getElementById("new_task_input").value;
			// alert(new_task_input);
			let newTask = `<h2 id=${id}> <p>Task number ${id}: ${new_task_input} 
		<button class="deleteButt" 
		onClick="{deleteTask(${id})}"
		>
		Delete this task
		</button>
		</p> 
		</h2>`;
			id += 1;

			document.getElementById("tasks_div").innerHTML += newTask;
			return;


			*/
		}

		function loadJSONtasks() {
			// returns a promise object

			return fetch("/tasks.json")
				.then(response => {
					if (!response.ok) {
						throw new Error("HTTP error " + response.status);
					}
					return response.json();
				})
				//.then(json => taskContainer = json) // not needed ?
				.catch(error => {
					/* Error handling */
					console.log(error)
				});

			//console.dir("tasks:", JSON.parse(JSON.stringify(tasks)));

		}

		// function displayJSONtasks(PromiseData) {
		// 	console.log(PromiseData);
		// 	alert(typeof (PromiseData.value))
		// }

		async function displayJSONtasks(){
			let result = await loadJSONtasks();
			let tasks = result["tasks"];
			let divTasks = document.getElementById("new_task_div");
			tasks.forEach((task)=>{console.log(task);divTasks.innerHTML+=(`<div><p>Task id: ${task["id"]}, 
				task Name: ${task["title"]}, date: ${task["date"]}, 
				description: ${task["description"]} 
				 </p></div>`)});

	
			// divTasks.innerHTML+=(`<p>Task id: ${tasks[0]["id"]}, 
			// 	task Name: ${tasks[0]["title"]}, date: ${tasks[0]["date"]}, 
			// 	description: ${tasks[0]["description"]} 
			// 	 </p>`);
			// console.log(result);
			// console.log(result["tasks"][0])
			return;
		}

		
		// async function doSomething() {
		// 	let result = await functionThatReturnsPromiseA();
		// 	return result + 1;
		// }


	</script>
</head>

<body>
	<main>

		<section>
			<h1>
				To Do App
			</h1>

			<div id="tasks_div" class="app">




				<div id="new_task_div">




					<a href="newTask.html">
						<input type="button" value="Add task" />
					</a>


				</div>

			</div>
		</section>

	</main>
</body>

</html>